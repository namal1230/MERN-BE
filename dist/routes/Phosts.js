"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = __importDefault(require("express"));
const PhostsController_1 = require("../controllers/PhostsController");
const PDFController_1 = require("../controllers/PDFController");
const ReportPhostController_1 = require("../controllers/ReportPhostController");
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
const morgan_1 = __importDefault(require("morgan"));
const Auth_1 = __importDefault(require("../middleware/Auth"));
const phostsRouter = express_1.default.Router();
const LOG_DIR = path_1.default.join(process.cwd(), "logs");
if (!fs_1.default.existsSync(LOG_DIR)) {
    fs_1.default.mkdirSync(LOG_DIR);
}
const accessLogStream = fs_1.default.createWriteStream(path_1.default.join(LOG_DIR, "phosts.log"), { flags: "a" });
phostsRouter.use((0, morgan_1.default)("tiny", { stream: accessLogStream }));
phostsRouter.post("/save-phost", Auth_1.default, PhostsController_1.savePhost);
phostsRouter.get("/draft-phost", Auth_1.default, PhostsController_1.getDraftPhosts);
phostsRouter.get("/get-draft-phost", Auth_1.default, PhostsController_1.getDraftPhost);
phostsRouter.get("/get-reported-phost", Auth_1.default, PhostsController_1.getReportByPhostId);
phostsRouter.get("/remove-report", Auth_1.default, PhostsController_1.deactivateReportedPhost);
phostsRouter.delete("/delete-phost", Auth_1.default, PhostsController_1.deletePhost);
phostsRouter.put("/edit-phost", Auth_1.default, PhostsController_1.editPhost);
phostsRouter.get("/get-all-pending", Auth_1.default, PhostsController_1.getAllPendingPhosts);
phostsRouter.get("/approve-phost", Auth_1.default, PhostsController_1.publishPhost);
phostsRouter.get("/get-phost", Auth_1.default, PhostsController_1.getPhostById);
phostsRouter.get("/reject-phost", Auth_1.default, PhostsController_1.rejectPhost);
phostsRouter.get("/get-all-report", Auth_1.default, PhostsController_1.getAllReportPhosts);
phostsRouter.get("/published-phost", Auth_1.default, PhostsController_1.getAllPublishedPhosts);
phostsRouter.get("/download-phost", Auth_1.default, PDFController_1.downloadPostPDF);
phostsRouter.post("/report-phost", Auth_1.default, ReportPhostController_1.reportPhost);
phostsRouter.post("/save-reaction", Auth_1.default, PhostsController_1.saveReaction);
phostsRouter.post("/get-reaction", Auth_1.default, PhostsController_1.getReactionsStats);
phostsRouter.post("/find-phost", Auth_1.default, PhostsController_1.searchPhosts);
phostsRouter.get("/get-notification", Auth_1.default, PhostsController_1.getUserReactions);
phostsRouter.get("/set-notification", Auth_1.default, PhostsController_1.setNotificationStatus);
phostsRouter.get("/get-report-email", Auth_1.default, ReportPhostController_1.getReportedPhostById);
phostsRouter.get("/get-archived-phost", Auth_1.default, PhostsController_1.getArchivedPhostsByUsername);
exports.default = phostsRouter;
